import{o as n,c as a,a as g,b as o,k as u,l as m,m as v,A as l,F as d,D as p,u as y,n as f,H as h}from"./vendor.3ce90362.js";import{_}from"./flecha-izquierda.f982a190.js";import{T as x}from"./vuejs-tree.common.02dd7996.js";import{n as w,c as F}from"./navbar.3dc83e26.js";import"./Logocompleto.3df4452e.js";const b={class:"container-fluid"},T={class:"row"},S={class:"col-md-2",style:{height:"calc(100vh - 70px)",overflow:"hidden","overflow-y":"auto",padding:"0"}},D={class:"col-md-10",style:{height:"calc(100vh - 70px)",overflow:"hidden"}},N={class:"row"},O={class:"col-md-3",style:{height:"calc(100vh - 70px)",overflow:"hidden","overflow-y":"auto","padding-top":"15px"}},k={class:"col-12",style:{padding:"0"}},C={class:"row"},P={class:"col-2 text-center",style:{"padding-top":"5px","padding-bottom":"5px"}},j=o("img",{src:_,style:{height:"15px",width:"15px"}},null,-1),$=[j],I={class:"col-md-9",style:{padding:"0","margin-bottom":"15px"}},q=o("button",{type:"submit",hidden:"true"},null,-1),z=o("div",{class:"col-md-12",style:{padding:"0px","font-size":"13px","margin-bottom":"15px"}}," Seleccion\xE1 carpetas y/o etiquetas, para obtener mejores resultados ",-1),A=o("hr",null,null,-1),M=o("div",{class:"col-md-12",style:{padding:"0px","margin-bottom":"15px"}},[o("i",{class:"fas fa-filter"}),f(" Filtros ")],-1),E={class:"col-md-12",style:{padding:"0"}},H={key:0,style:{"font-size":"12px"}},L={style:{margin:"0",padding:"0","list-style":"none"}},R={style:{padding:"7px"}},B={href:"#",style:{padding:"5px 8px",background:"rgb(236, 236, 236)","border-radius":"30px","font-size":"9.5px","font-weight":"600","margin-right":"10px","margin-bottom":"5px"}},J=["onClick"],V=o("i",{class:"fas fa-times"},null,-1),W=[V],Y={key:1},U=o("hr",null,null,-1),G=[U],K={style:{padding:"7px"}},Q={href:"#",style:{padding:"5px 8px",background:"rgb(236, 236, 236)","border-radius":"30px","font-size":"9.5px","font-weight":"600","margin-right":"10px","margin-bottom":"5px"}},X=["onClick"],Z=o("i",{class:"fas fa-times"},null,-1),ee=[Z],te=o("div",{class:"col-md-12",style:{padding:"15px",background:"rgb(243 243 243)","padding-top":"3px","padding-bottom":"3px","font-size":"13px","font-weight":"600",color:"#505050","margin-bottom":"15px","margin-top":"15px","text-transform":"uppercase"}}," Carpetas ",-1),se={class:"col-md-12"},oe=o("div",{class:"col-md-12",style:{padding:"15px",background:"rgb(243 243 243)","padding-top":"3px","padding-bottom":"3px","font-size":"13px","font-weight":"600",color:"#505050","margin-bottom":"15px","margin-top":"15px","text-transform":"uppercase"}}," Etiquetas ",-1),re={class:"col-md-12",style:{padding:"0"}},ie={key:0,style:{"font-size":"12px"}},ne={style:{margin:"0",padding:"0","list-style":"none"}},ae={style:{padding:"7px"}},le=["onClick"],de={class:"col-md-9 scroll-size-medium",style:{height:"calc(100vh - 70px)",overflow:"hidden","overflow-y":"auto","padding-top":"15px"}},he={class:"row",style:{border:"1px solid #d0cece","border-radius":"8px",width:"100%"}},ce=o("div",{class:"col-md-12",style:{padding:"15px",background:"rgb(251 251 251)","padding-top":"3px","padding-bottom":"3px","font-size":"13px","font-weight":"600",color:"#505050","margin-bottom":"15px","text-transform":"uppercase","border-top-left-radius":"8px","border-top-right-radius":"8px"}}," Resultados de busqueda ",-1),pe={style:{height:"80vh",overflow:"hidden","overflow-y":"auto",width:"100%"}},ge={class:"col-md-12",style:{"border-bottom":"1px solid #d0cece",width:"100%"}},ue={class:"row"},fe={class:"col-md-9"},me=["onClick"],ve=["onClick"],ye=["innerHTML"],_e={data(){return{auth:localStorage.getItem("auth"),endpointSearchWriting:window.ENDPOINT+"/search/writing",endpointSearchDocument:window.ENDPOINT+"/search/document",endpointSearchTags:window.ENDPOINT+"/search/regex/tags",searchMode:"document",searchInput:{target:this.$route.query.search},searchDocuments:[],searchFolders:[],searchTags:[],searchFoldersDocuments:[],teste:[],BestDocuments:[],bestWritings:[],tagFilters:[],foldersFilters:[],document:[{data:{title:null}}],treeDisplayData:[],accessSpeed:!1}},created(){console.log("BestDocuments",this.BestDocuments)},mounted(){this.$route.query.tag&&this.tagFilters.push({title:this.$route.query.tag,id:this.$route.query.id}),this.getResults(),this.getFolderAll()},computed:{myCustomStyles(){return{tree:{style:{height:"auto",maxHeight:"300px",overflowY:"visible",display:"inline-block",textAlign:"left"}},row:{style:{width:"500px",cursor:"pointer"},child:{class:"",style:{height:"35px"},active:{style:{height:"35px"}}}},rowIndent:{paddingLeft:"20px"},text:{style:{"font-weight":"600","font-size":"12px"},active:{style:{"font-weight":"bold",color:"#1200FF","font-size":"12px"}}}}},myCustomOptions(){return{treeEvents:{expanded:{state:!0,fn:this.getDocumentsFromFolder},collapsed:{state:!0,fn:this.getDocumentsFromFolder},selected:{state:!1,fn:this.mySelectedFunction},checked:{state:!1,fn:this.myCheckedFunction}},events:{expanded:{state:!0},selected:{state:!0},checked:{state:!0},editableName:{state:!0,calledEvent:"expanded"}},addNode:{state:!0,class:"add_icon",style:{color:"red"},fn:this.addNodeFunction,appearOnHover:!0},editNode:{state:!0,fn:null,appearOnHover:!0},deleteNode:{state:!0,fn:this.deleteNodeFunction,appearOnHover:!0},showTags:!0}},myCustomStyles2(){return{tree:{style:{height:"auto",maxHeight:"300px",overflowY:"visible",display:"inline-block",textAlign:"left"}},deleteNode:{class:"button-move-tree",style:{color:"#EE5F5B"}},row:{style:{width:"500px",cursor:"pointer"},child:{class:"",style:{height:"35px"},active:{style:{height:"35px"}}}},rowIndent:{paddingLeft:"20px"},text:{style:{"font-weight":"600","font-size":"12px"},active:{style:{"font-weight":"bold",color:"#1200FF","font-size":"12px"}}}}},myCustomOptions2(){return{treeEvents:{expanded:{state:!0,fn:t=>{this.getChilds(t)}},collapsed:{state:!0,fn:this.mySelectedFunction},selected:{state:!1,fn:this.mySelectedFunction},checked:{state:!1,fn:this.myCheckedFunction}},events:{expanded:{state:!0},selected:{state:!0},checked:{state:!0},editableName:{state:!0,calledEvent:"expanded"}},addNode:{state:!1,class:"add_icon",style:{color:"red"},fn:this.addNodeFunction,appearOnHover:!0},editNode:{state:!1,fn:null,appearOnHover:!0},deleteNode:{state:!0,fn:this.selectPathMove,appearOnHover:!1},showTags:!0}},filteredResources(){return this.foldersFilters.length>0||this.tagFilters.length>0?this.searchDocuments.filter(t=>{if(this.foldersFilters.length>0&&this.tagFilters.length==0)for(var e=t.data.categories.length-1;e>=0;e--)for(var r=t.data.categories[e],e=this.foldersFilters.length-1;e>=0;e--){var s=this.foldersFilters[e];if(r.id==s.id)return t}if(this.tagFilters.length>0&&this.foldersFilters.length==0){console.log("tags filter active");for(var e=t.data.tags.length-1;e>=0;e--)for(var r=t.data.tags[e],i=this.tagFilters.length-1;i>=0;i--){var s=this.tagFilters[i];if(console.log("loop tags",t.data.title,r._id,s.id),r._id==s.id)return console.log("document active",r._id,s.id),t}}if(this.foldersFilters.length>0&&this.tagFilters.length==0)for(var e=t.data.tags.length-1;e>=0;e--)for(var r=t.data.tags[e],e=this.foldersFilters.length-1;e>=0;e--){var s=this.foldersFilters[e];if(r._id==s.id)return t}if(this.foldersFilters.length>0&&this.tagFilters.length>0)for(var e=t.data.categories.length-1;e>=0;e--)for(var r=t.data.categories[e],e=this.foldersFilters.length-1;e>=0;e--){var s=this.foldersFilters[e];if(r.id==s.id){if(this.tagFilters.length>0){console.log(this.tagFilters);for(var e=t.data.tags.length-1;e>=0;e--){var r=t.data.tags[e];console.log("search ",t.data.title);for(var e=this.tagFilters.length-1;e>=0;e--){var s=this.tagFilters[e];if(console.log("ids",r._id,s.id),r._id==s.id)return t}}}return t}}}):this.searchDocuments}},methods:{getFolderAll(){const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth:this.auth})};fetch(window.ENDPOINT+"/folders/v2/default/documents",t).then(e=>e.json()).then(e=>{this.treeDisplayData=this.prepareArray(e)})},getChilds(t){this.$Progress.start();const e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth:this.auth,parent:t})};fetch(window.ENDPOINT+"/folders/v2/default/documents/childs",e).then(r=>r.json()).then(r=>{this.$refs["my-tree"].findNode(t).nodes=this.prepareArray(r),this.nodeSelect=this.prepareArray(r),this.$Progress.finish()})},prepareArray(t){for(var e=[],r=t.length-1;r>=0;r--)e.push({id:t[r]._id,text:t[r].data.text,nodes:[{id:"934",text:"Cargando carpetas..",nodes:[],state:{checked:!1,selected:!1,expanded:!1}}],state:{checked:!1,selected:!1,expanded:!1}});return e},pathMoveSelectedRemove(t,e){delete this.pathMoveSelected[t],this.pathMoveSelected=this.pathMoveSelected.filter(function(r){return typeof r!="undefined"})},selectPathMove(t){console.log(t),this.selectFolder(t.id,t.text)},removeFilterTag(t){this.tagFilters.splice(t,1),this.getResults()},removeFilterFolder(t){this.foldersFilters.splice(t,1),this.getResults()},selectTag(t,e){this.tagFilters.push({id:t,title:e}),console.log("tags selected ",this.tagFilters),this.getResults()},selectFolder(t,e){this.foldersFilters.push({id:t,title:e}),this.getResults()},getStars(t){if(t<=10)return 1;if(t<=20)return 2;if(t<=30)return 3;if(t<=40)return 4;if(t<=50||t>=50)return 5},displayStars(t){for(var e='<svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000" style="fill: #ead723"><g><path d="M0,0h24v24H0V0z" fill="none"/><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,17.27L18.18,21l-1.64-7.03L22,9.24l-7.19-0.61L12,2L9.19,8.63L2,9.24l5.46,4.73L5.82,21L12,17.27z"/></g></svg>',r=this.getStars(t),s=1,i="";s<=r;)i=i+e,s++;return i},goToDocument(t){this.$router.push({name:"view-document",params:{id:t}})},gotoFolder(t){this.$router.push({name:"search",query:{folder:t}})},gotoTag(t){this.$router.push({name:"search",query:{tag:t}})},gotoSearch(){this.$router.push({name:"search",query:{search:this.searchInput.target}})},changeMode(t){this.searchMode=t},getResults(){return new Promise((t,e)=>{const r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth:this.auth,search:this.searchInput.target,tags:this.tagFilters,folders:[]})};fetch(window.ENDPOINT+"/comunity/search/complete/documents",r).then(s=>s.json()).then(s=>{console.log("send request results ",s),s.length==0?(this.searchDocuments=[],this.searchAllTags().then(i=>{this.searchTags=i})):(this.searchDocuments=s,this.searchAllTags().then(i=>{this.searchTags=i}))})})},getResultsStartSpeed(){return new Promise((t,e)=>{const r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth:this.auth,search:this.searchInput.target,tags:this.tagFilters,folders:[]})};fetch(window.ENDPOINT+"/comunity/search/complete/documents",r).then(s=>s.json()).then(s=>{s.length==0?(this.searchDocuments=[],this.searchAllTags().then(i=>{this.searchTags=i})):(this.searchDocuments=s,this.searchAllTags().then(i=>{this.searchTags=i}))})})},searchAllDocuments(){return new Promise((t,e)=>{const r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth:this.auth,search:this.searchInput.target})};if(this.searchMode=="document")var s=this.endpointSearchDocument;else var s=this.endpointSearchWriting;fetch(s,r).then(i=>i.json()).then(i=>{i.length==0?t([]):t(i)})})},searchAllTags(){return new Promise((t,e)=>{const r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth:this.auth,search:this.searchInput.target})};fetch(this.endpointSearchTags,r).then(s=>s.json()).then(s=>{s.length==0?t([]):t(s)})})},searchAllFoldersDocuments(){return new Promise((t,e)=>{const r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth:this.auth,search:this.searchInput.target})};if(this.searchMode=="document")var s=window.ENDPOINT+"/search/folders/documents";else var s=this.endpointSearchWriting;fetch(s,r).then(i=>i.json()).then(i=>{i.empty?t([]):t(i)})})},search(){this.$Progress.start(),this.searchAllDocuments().then(t=>{this.searchDocuments=t}),this.searchAllTags().then(t=>{this.searchTags=t}),this.searchAllFoldersDocuments().then(t=>{this.searchFoldersDocuments=t}),this.$Progress.finish()},pause(){},hover(){}}},Se=Object.assign(_e,{setup(t){return(e,r)=>(n(),a(d,null,[g(w),o("main",null,[o("div",b,[o("div",T,[o("div",S,[g(F)]),o("div",D,[o("div",N,[o("div",O,[o("div",k,[o("div",C,[o("div",P,[o("a",{href:"@",onClick:r[0]||(r[0]=u(s=>e.$router.go(-1),["prevent"]))},$)]),o("div",I,[o("form",{onSubmit:r[2]||(r[2]=u(s=>e.getResults(),["prevent"]))},[m(o("input",{type:"text",class:"form-control type-input-4","onUpdate:modelValue":r[1]||(r[1]=s=>e.searchInput.target=s)},null,512),[[v,e.searchInput.target]]),q],32)])])]),z,A,M,o("div",E,[e.foldersFilters.length==0&&e.tagFilters.length==0?(n(),a("b",H,"No se han colocado filtros.")):l("",!0),o("ul",L,[e.foldersFilters.length>0?(n(!0),a(d,{key:0},p(e.foldersFilters,(s,i)=>(n(),a("li",R,[o("a",B,[f(h(s.title)+" ",1),o("a",{href:"#",style:{"margin-left":"10px"},onClick:c=>e.removeFilterFolder(i)},W,8,J)])]))),256)):l("",!0),e.foldersFilters.length>0?(n(),a("li",Y,G)):l("",!0),e.tagFilters.length>0?(n(!0),a(d,{key:2},p(e.tagFilters,(s,i)=>(n(),a("li",K,[o("a",Q,[f(h(s.title)+" ",1),o("a",{href:"#",style:{"margin-left":"10px"},onClick:c=>e.removeFilterTag(i)},ee,8,X)])]))),256)):l("",!0)])]),te,o("div",se,[g(y(x),{id:"my-tree-id",ref:"my-tree","custom-options":e.myCustomOptions2,"custom-styles":e.myCustomStyles2,nodes:e.treeDisplayData},null,8,["custom-options","custom-styles","nodes"])]),oe,o("div",re,[e.searchTags.length==0?(n(),a("b",ie,"No se han encontrado etiquetas.")):l("",!0),o("ul",ne,[e.searchTags.length>0?(n(!0),a(d,{key:0},p(e.searchTags,(s,i)=>(n(),a("li",ae,[o("a",{href:"#",style:{padding:"5px 8px",background:"rgb(236, 236, 236)","border-radius":"30px","font-size":"9.5px","font-weight":"600","margin-right":"10px","margin-bottom":"5px"},onClick:u(c=>e.selectTag(s._id,s.data.title),["prevent"])},h(s.data.title),9,le)]))),256)):l("",!0)])])]),o("div",de,[o("div",he,[ce,o("div",pe,[e.searchDocuments.length>0?(n(!0),a(d,{key:0},p(e.filteredResources,(s,i)=>(n(),a("div",ge,[o("div",ue,[o("div",fe,[o("b",{style:{"font-size":"14px",cursor:"pointer"},onClick:c=>e.goToDocument(s._id)},h(s.data.title),9,me),o("p",{style:{"font-size":"13px",cursor:"pointer"},onClick:c=>e.goToDocument(s._id)},h(s.data.description),9,ve)]),o("div",{class:"col-md-3",innerHTML:e.displayStars(s.data.cout_validate)},null,8,ye)])]))),256)):l("",!0)])])])])])])])])],64))}});export{Se as default};
