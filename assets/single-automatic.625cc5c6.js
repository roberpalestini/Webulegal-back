import{j as _,o as n,c as a,a as b,b as t,l as d,k as c,H as r,x,A as h,F as g,D as f,m,n as y}from"./vendor.3ce90362.js";import{_ as w}from"./flecha-izquierda.f982a190.js";import{_ as T}from"./etiqueta.f26d8a8f.js";import{n as k,c as O}from"./navbar.3dc83e26.js";import{T as v}from"./toolbar-writings-comunity.edad3899.js";import"./Logocompleto.3df4452e.js";import"./cuota.edac84f3.js";const D={class:"container-fluid"},N={class:"row"},P={class:"col-md-2",style:{height:"calc(100vh - 70px)",overflow:"hidden","overflow-y":"auto",padding:"0"}},C={class:"col-md-10 text-center",style:{padding:"20px",border:"1px solid #E2E2E2",background:"rgb(255,255,255,0.1)",height:"calc(100vh - 70px)",overflow:"hidden","overflow-y":"auto"}},S={class:"row justify-content-center"},j={class:"col-12 text-left",style:{"padding-top":"0","padding-bottom":"20px"}},E=t("img",{src:w,style:{height:"20px",width:"20px"}},null,-1),M=[E],z={class:"col-12 text-left"},I={style:{padding:"0",margin:"0","margin-top":"8px","font-size":"14px"}},L=y("Compartido por: "),V={style:{padding:"0",margin:"0","margin-top":"8px","font-size":"14px"}},q=y("Puntuacion: "),U=["innerHTML"],A=t("p",{style:{padding:"0",margin:"0","margin-top":"8px","font-size":"14px"}},"Para crear el documento, completa el siguiente cuestionario",-1),B={class:"col-4",style:{position:"relative"}},H={class:"col-12 view-writing-fields-content"},J={key:0,class:"col-12",style:{padding:"0","min-height":"380px"}},R={class:"form-group",style:{"text-align":"left",padding:"10px"}},K={style:{"font-size":"13px",color:"black","font-weight":"600"}},F=["onUpdate:modelValue","onKeyup"],G={key:1,class:"col-12",style:{padding:"0","min-height":"380px"}},Q={key:0,class:"form-group",style:{"text-align":"left",padding:"10px"}},W={style:{"font-size":"13px",color:"black","font-weight":"600"}},X=["onUpdate:modelValue","onKeyup"],Y={class:"col-8"},Z={class:"col-12 view-writing-content"},tt=t("div",{class:"col-12 header"}," Previsualizacion del documento ",-1),et=["innerHTML"],ot={class:"col-12",style:{"margin-top":"100px"}},it=t("div",{class:"col-12 text-left"},[t("b",null,"Comentarios")],-1),st={class:"col-12",style:{"margin-top":"20px",display:"flex","margin-bottom":"50px"}},nt={class:"",style:{display:"flex",width:"auto","text-align":"left","flex-direction":"column"}},at={style:{"font-size":"13px"}},rt={class:"",style:{display:"flex",width:"auto",background:"rgb(246 246 246 / 39%)","align-items":"center",padding:"15px","border-radius":"14px","text-align":"left","margin-top":"10px",border:"1px solid #d6d6d6","padding-left":"20px"}},dt={style:{"font-size":"11px",opacity:"0.8","margin-left":"20px"}},lt={style:{display:"flex","align-items":"center","justify-content":"center","align-content":"center",width:"50px","padding-left":"20px","padding-top":"20px"}},pt=["onClick"],ct=t("img",{src:T},null,-1),mt=[ct],ut={style:{display:"flex",width:"100%"}},ht=t("div",{style:{display:"flex",width:"250px"}},[t("button",{type:"submit",class:"btn btn-primary",style:{width:"auto",position:"relative"}},"Enviar comentario")],-1),gt={class:"modal fade commentModal",id:"report-content",tabindex:"-1",role:"dialog","aria-labelledby":"report-contentTitle","aria-hidden":"true"},yt={class:"modal-dialog modal-dialog-centered modal-sm",role:"document"},ft={class:"modal-content",style:{"border-radius":"10px",border:"none"}},bt=t("div",{class:"modal-header text-center",style:{background:"#dedcdc",color:"#454545","border-top-left-radius":"10px","border-top-right-radius":"10px"}},[t("h5",{class:"modal-title",style:{"font-size":"15px","font-weight":"600","text-align":"center !important",display:"block !important",width:"100%"}},"A\xF1adir nuevo comentario"),t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[t("span",{"aria-hidden":"true"},"\xD7")])],-1),vt={class:"col-md-12",style:{"margin-top":"20px"}},_t=t("div",{class:"col-md-12 text-center",style:{"margin-top":"20px"}},[t("button",{type:"submit",class:"btn btn-primary",style:{width:"auto",position:"relative"}},"Enviar comentario")],-1),xt={class:"modal fade",id:"report-content-message",tabindex:"-1",role:"dialog","aria-labelledby":"report-contentTitle","aria-hidden":"true"},wt={class:"modal-dialog modal-dialog-centered modal-sm",role:"document"},Tt={class:"modal-content",style:{"border-radius":"10px",border:"none"}},kt=t("div",{class:"modal-header text-center",style:{background:"#dedcdc",color:"#454545","border-top-left-radius":"10px","border-top-right-radius":"10px"}},[t("h5",{class:"modal-title",style:{"font-size":"15px","font-weight":"600","text-align":"center !important",display:"block !important",width:"100%"}},"Denunciar comentario"),t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[t("span",{"aria-hidden":"true"},"\xD7")])],-1),Ot=y(" \xBFPor qu\xE9 quer\xE9s denunciar este comentario ? "),Dt={class:"col-md-12",style:{"margin-top":"20px"}},Nt=t("div",{class:"col-md-12 text-center",style:{"margin-top":"20px"}},[t("button",{type:"submit",class:"btn btn-primary",style:{width:"120px",position:"relative"}},"Denunciar")],-1),Pt={components:{ToolBarDocument:v},data(){return{comments:[],temp:{comment:null,report:null,id:null},user:{},auth:localStorage.getItem("auth"),endpoint:window.ENDPOINT+"/comunity/documents/get",endpointTextPreview:window.ENDPOINT+"/comunity/fields/preview",endpointSaveDocument:window.ENDPOINT+"/comunity/document/copy/writing",endpointDetails:window.ENDPOINT+"/writings/documents/check/details",documentCopy:!1,details:{copy:!1,validate:!1},fields:[],content:null,version:"1.00",document:{_id:null,data:{title:"",description:"",content:"",validate:!1,user:{data:{profile:{lastname:null,firstname:null}}}}}}},created(){this.getDocument(this.$route.params.id),this.getAllComments(this.$route.params.id),this.getUserData()},mounted(){},computed:{},methods:{sendReport(){const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"comment",message:this.temp.report,id:this.temp.id,auth:localStorage.getItem("auth")})};fetch(window.ENDPOINT+"/requests/new/report/comments",s).then(e=>e.json()).then(e=>{this.$toast.success("Tu solicitud ha sido procesada. Muchas gracias por ayudarnos a mejorar",{position:"bottom-right"}),$("#report-content-message").modal("hide"),this.temp.report=null})},openReportModal(s){$("#report-content-message").modal("show"),this.temp.id=s},getUserData(){const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth:localStorage.getItem("auth")})};fetch(window.ENDPOINT+"/users/auth",s).then(e=>e.json()).then(e=>{this.user=e.data})},getAllComments(s){const e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth:this.auth,id:s})};fetch(window.ENDPOINT+"/comunity/comments/document",e).then(o=>o.json()).then(o=>{this.comments=o})},saveComment(){this.$Progress.start();const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth:this.auth,id:this.document._id,comment:this.temp.comment})};fetch(window.ENDPOINT+"/comunity/comments/create",s).then(e=>e.json()).then(e=>{this.$Progress.finish(),this.$toast.success("Comentario publicado",{position:"bottom-right"}),$(".commentModal").modal("hide"),this.getAllComments(this.$route.params.id)})},openNewComment(){$(".commentModal").modal("show")},createDocument(){this.$Progress.start();const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth:this.auth,id:this.document._id,doc_original:this.document.data.doc_original,fields:this.fields,content:this.content})};fetch(window.ENDPOINT+"/comunity/document/create/writing",s).then(e=>e.json()).then(e=>{this.$Progress.finish(),this.$toast.success("Documento creado correctamente",{position:"bottom-right"}),this.$router.push({name:"my-writings-folders",query:{id:e.insertedId}})})},getStars(s){if(s<=10)return 1;if(s<=20)return 2;if(s<=30)return 3;if(s<=40)return 4;if(s<=50||s>=50)return 5},displayStars(s){for(var e='<svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000" style="fill: #ead723"><g><path d="M0,0h24v24H0V0z" fill="none"/><path d="M0,0h24v24H0V0z" fill="none"/></g><g><path d="M12,17.27L18.18,21l-1.64-7.03L22,9.24l-7.19-0.61L12,2L9.19,8.63L2,9.24l5.46,4.73L5.82,21L12,17.27z"/></g></svg>',o=this.getStars(s),l=1,i="";l<=o;)i=i+e,l++;return console.log(o,l,i),i},getDocument(s){this.$Progress.start();const e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth:this.auth,id:s})};fetch(this.endpoint,e).then(o=>o.json()).then(o=>{this.document=o,this.fieldsDisplay(o.data.fields),this.content=o.data.content,this.getDetails=!0,o.data.version&&(this.version="2.00"),this.$Progress.finish()})},fieldsDisplay(s){this.fields=s},changeMode(s){},search(){},pause(){},hover(){},fieldsDisplay(s){this.fields=s},previewText(s){const e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth:this.auth,id:this.$route.params.id,fields:this.fields})};fetch(this.endpointTextPreview,e).then(o=>o.json()).then(o=>{console.log(o),this.content=o.content})}}},It=Object.assign(Pt,{setup(s){return(e,o)=>{const l=_("tooltip");return n(),a(g,null,[b(k),t("form",null,[t("div",D,[t("div",N,[t("div",P,[b(O)]),t("div",C,[t("div",S,[t("div",j,[d((n(),a("a",{href:"@",onClick:o[0]||(o[0]=c(i=>e.$router.go(-1),["prevent"]))},M)),[[l,"Regresar"]])]),t("div",z,[t("b",null,r(e.document.data.title),1),t("p",null,r(e.document.data.description),1),t("p",I,[L,t("b",null,r(e.document.data.user.data.profile.firstname)+" "+r(e.document.data.user.data.profile.lastname),1)]),t("p",V,[q,t("div",{innerHTML:e.displayStars(e.document.data.cout_validate),style:{display:"inline-block"}},null,8,U)]),A]),e.getDetails?(n(),x(v,{key:0,id:e.document._id},null,8,["id"])):h("",!0),t("div",B,[t("div",H,[e.version=="1.00"?(n(),a("div",J,[(n(!0),a(g,null,f(e.document.data.fields,(i,u)=>(n(),a("div",R,[t("label",K,r(i.replace),1),d(t("input",{type:"text",class:"form-control input-field",style:{height:"30px !important","min-height":"30px !important","border-top":"none !important","border-right":"none !important","border-bottom":"2px solid rgb(141, 141, 141) !important","border-left":"none !important","border-image":"initial !important",background:"transparent !important","font-size":"13px !important",color:"black !important","font-weight":"500 !important","border-radius":"0 !important"},"onUpdate:modelValue":p=>i.user.input=p,onKeyup:p=>e.previewText(u)},null,40,F),[[m,i.user.input]])]))),256))])):h("",!0),e.version=="2.00"?(n(),a("div",G,[(n(!0),a(g,null,f(e.document.data.fields,(i,u)=>(n(),a("div",null,[i.existent==!1?(n(),a("div",Q,[t("label",W,r(i.replace),1),d(t("input",{type:"text",class:"form-control input-field",style:{height:"30px !important","min-height":"30px !important","border-top":"none !important","border-right":"none !important","border-bottom":"2px solid rgb(141, 141, 141) !important","border-left":"none !important","border-image":"initial !important",background:"transparent !important","font-size":"13px !important",color:"black !important","font-weight":"500 !important","border-radius":"0 !important"},"onUpdate:modelValue":p=>i.user.input=p,onKeyup:p=>e.previewText(u)},null,40,X),[[m,i.user.input]])])):h("",!0)]))),256))])):h("",!0),t("a",{class:"btn btn-primary",style:{width:"120px",position:"relative"},onClick:o[1]||(o[1]=i=>e.createDocument())},"Crear")])]),t("div",Y,[t("div",Z,[tt,t("div",{class:"col-12 content",innerHTML:e.content,style:{color:"black"}},null,8,et)])]),t("div",ot,[it,(n(!0),a(g,null,f(e.comments,i=>(n(),a("div",st,[t("div",nt,[t("b",at,r(i.user.firstname)+" "+r(i.user.lastname),1),t("div",rt,[y(r(i.comment)+" ",1),t("small",dt,r(i.date),1)])]),t("div",lt,[d((n(),a("a",{href:"#",class:"icons-link",onClick:c(u=>e.openReportModal(i._id),["prevent"])},mt,8,pt)),[[l,"Reportar Comentario"]])])]))),256)),t("form",{onSubmit:o[3]||(o[3]=c(i=>e.saveComment(),["prevent"])),class:"col-12",style:{"margin-top":"20px",display:"flex"}},[t("div",ut,[d(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[2]||(o[2]=i=>e.temp.comment=i),placeholder:"Escribe un comentario..",style:{"border-radius":"30px",border:"1px solid rgb(199, 199, 199) !important",background:"rgb(251 251 251) !important"}},null,512),[[m,e.temp.comment]])]),ht],32)])])])])])]),t("div",gt,[t("div",yt,[t("div",ft,[bt,t("form",{onSubmit:o[5]||(o[5]=c(i=>e.saveComment(),["prevent"])),class:"modal-body"},[t("div",vt,[d(t("textarea",{class:"form-control","onUpdate:modelValue":o[4]||(o[4]=i=>e.temp.comment=i),placeholder:"Escribe un comentario..",style:{"min-height":"100px","border-radius":"30px",border:"1px solid rgb(199, 199, 199)",background:"rgb(231, 231, 231)"}},null,512),[[m,e.temp.comment]])]),_t],32)])])]),t("div",xt,[t("div",wt,[t("div",Tt,[kt,t("form",{onSubmit:o[7]||(o[7]=c(i=>e.sendReport(),["prevent"])),class:"modal-body"},[Ot,t("div",Dt,[d(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[6]||(o[6]=i=>e.temp.report=i),style:{height:"30px","min-height":"33px","border-radius":"30px",border:"1px solid rgb(199, 199, 199)",background:"rgb(231, 231, 231)"}},null,512),[[m,e.temp.report]])]),Nt],32)])])])],64)}}});export{It as default};
