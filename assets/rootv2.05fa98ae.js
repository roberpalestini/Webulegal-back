import{o as i,c as n,a as c,b as t,k as a,u as b,F as h,D as v,H as p,A as u,M as _,l as m,m as f,n as y,p as w}from"./vendor.3ce90362.js";import{_ as g}from"./admin-add.c0a05d7b.js";import{_ as k,a as F}from"./delete.89e1e206.js";import{_ as N}from"./boligrafo.1cbc6d81.js";import{n as S,c as C}from"./navbar.3dc83e26.js";import"./core.77a31e8a.js";import{T as D}from"./vuejs-tree.common.02dd7996.js";import"./Logocompleto.3df4452e.js";const E={class:"container-fluid"},P={class:"col-md-2",style:{height:"calc(100vh - 70px)",overflow:"hidden","overflow-y":"auto",padding:"0"}},O={class:"col-md-10 text-center",style:{padding:"20px",border:"1px solid #F3F3F3",background:"rgb(255,255,255,0.1)",height:"calc(100vh - 70px)",overflow:"hidden","overflow-y":"auto","padding-top":"60px"}},M={class:"row"},B={class:"col-md-4",style:{height:"calc(100vh - 70px)",overflow:"hidden","overflow-y":"auto"}},T=t("div",{class:"col-md-12"},[t("h4",{style:{"font-weight":"bold","text-align":"left","font-size":"17px"}},"Navegacion")],-1),I={class:"col-12 text-left",style:{"padding-top":"30px","padding-bottom":"30px"}},z=t("img",{src:g,style:{width:"20px"}},null,-1),j=y(" Nueva carpeta raiz"),L=[z,j],q=t("hr",null,null,-1),A={style:{padding:"0px","list-style":"none",width:"100%",display:"flex","justify-content":"flex-start","align-items":"center","flex-direction":"column","align-content":"flex-start"}},R={style:{width:"100%",display:"flex","justify-content":"flex-start","align-items":"flex-start","flex-direction":"column","align-content":"flex-start","margin-bottom":"5px"}},V={href:"#",style:{"font-size":"12px",padding:"5px",background:"rgb(234, 234, 234)","border-radius":"30px",display:"flex","place-content":"flex-start","align-items":"center","flex-direction":"row","padding-left":"10px","padding-right":"10px"}},X=["onClick"],Y=t("i",{class:"fas fa-times"},null,-1),J=[Y],H={style:{"text-align":"left"}},U={key:0},G={key:0},K={key:1},Q={class:"row"},W={class:"col-3",style:{padding:"5px"}},Z={class:"col-12 text-center folder"},ee=["onClick"],te=["onClick"],se=["onClick"],oe=t("img",{src:N,style:{width:"15px",height:"15px"}},null,-1),de=[oe],ae=["onClick"],ie=t("img",{src:F,style:{width:"15px",height:"15px"}},null,-1),ne=[ie],le={style:{padding:"0",margin:"0","list-style":"none"}},re=t("a",{href:"#",style:{"font-size":"11px","font-weight":"600",color:"black"}},[t("img",{src:g}),y(" Carpeta nueva")],-1),ce=[re],he={class:"modal fade",id:"staticBackdrop","data-backdrop":"static","data-keyboard":"true",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},pe={class:"modal-dialog modal-dialog-centered modal-sm"},ue=t("div",{class:"modal-header",style:{border:"none"}},[t("h5",{class:"modal-title",id:"staticBackdropLabel",style:{"font-size":"15px"}},"Nueva carpeta"),t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[t("span",{"aria-hidden":"true"},"\xD7")])],-1),me={class:"modal-body"},fe=t("div",{class:"modal-footer",style:{border:"none"}},[t("button",{type:"submit",class:"btn btn-primary",style:{"font-size":"15px"}},"Crear carpeta")],-1),ye={class:"modal fade",id:"staticBackdrop3","data-backdrop":"static","data-keyboard":"true",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},ve={class:"modal-dialog modal-dialog-centered modal-sm"},ge=t("div",{class:"modal-header",style:{border:"none"}},[t("h5",{class:"modal-title",id:"staticBackdropLabel",style:{"font-size":"15px"}},"Nueva carpeta"),t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[t("span",{"aria-hidden":"true"},"\xD7")])],-1),xe={class:"modal-body"},be=t("div",{class:"modal-footer",style:{border:"none"}},[t("button",{type:"submit",class:"btn btn-primary",style:{"font-size":"15px"}},"Crear carpeta")],-1),_e={class:"modal fade",id:"staticBackdrop2","data-backdrop":"static","data-keyboard":"true",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},we={class:"modal-dialog modal-dialog-centered modal-sm"},ke=t("div",{class:"modal-header",style:{border:"none"}},[t("h5",{class:"modal-title",id:"staticBackdropLabel",style:{"font-size":"15px"}},"Editar carpeta"),t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[t("span",{"aria-hidden":"true"},"\xD7")])],-1),Fe={class:"modal-body"},Ne=t("div",{class:"modal-footer",style:{border:"none"}},[t("button",{type:"submit",class:"btn btn-primary",style:{"font-size":"15px"}},"Guardar")],-1),Se={class:"modal fade",id:"staticBackdrop4","data-backdrop":"static","data-keyboard":"true",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},Ce={class:"modal-dialog modal-dialog-centered modal-sm"},De=w('<div class="modal-header" style="border:none;"><h5 class="modal-title" id="staticBackdropLabel" style="font-size:15px;">Eliminar carpeta</h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">\xD7</span></button></div><div class="modal-body text-danger"> Esta accion no se puede deshacer </div><div class="modal-footer" style="border:none;"><button type="submit" class="btn btn-primary" style="font-size:15px;">Eliminar</button></div>',3),$e=[De],Ee={data(){return{data:{},auth:localStorage.getItem("auth"),endpointGetAll:window.ENDPOINT+"/folders/v2/default/documents",endpointSave:window.ENDPOINT+"/folders/v2/default/documents/save/root",leaveFolderItem:!1,targetEditIndex:0,nameEditFolder:{title:null},showContextMenu:!1,selected:{row:{},action:"",clientX:null,clientY:null},showContextMenuFolder:!1,selectedFolder:{row:{},action:"",clientX:null,clientY:null},nameNewFolder:{title:null},modalCreate:!1,inputCreate:null,categories:[],categoriesSelected:[],tags:[],tagSelected:[],title:null,description:null,id_document:this.$route.params.id,nodeSelect:[{text:"rara",id:23,nodes:[]}],pathMoveSelected:[],treeDisplayData:[],temp:{index:null,node:null}}},created(){document.addEventListener("click",()=>{this.showContextMenu=!1,this.selected.row={},this.selected.clientX=null,this.selected.clientY=null})},mounted(){this.getFolderAll()},computed:{myCustomStyles2(){return{tree:{style:{height:"auto",maxHeight:"300px",overflowY:"visible",display:"inline-block",textAlign:"left"}},addNode:{class:"button-add-tree",style:{color:"#EE5F5B"}},editNode:{class:"button-edit-tree",style:{color:"#EE5F5B"}},deleteNode:{class:"button-move-tree",style:{color:"#EE5F5B"}},row:{style:{width:"500px",cursor:"pointer"},child:{class:"",style:{height:"35px"},active:{style:{height:"35px"}}}},rowIndent:{paddingLeft:"20px"},text:{style:{"font-weight":"600","font-size":"12px"},active:{style:{"font-weight":"bold",color:"#1200FF","font-size":"12px"}}}}},myCustomOptions2(){return{treeEvents:{expanded:{state:!0,fn:o=>{this.getChilds(o)}},collapsed:{state:!0,fn:this.mySelectedFunction},selected:{state:!1,fn:this.mySelectedFunction},checked:{state:!1,fn:this.myCheckedFunction}},events:{expanded:{state:!0},selected:{state:!0},checked:{state:!0},editableName:{state:!0,calledEvent:"expanded"}},addNode:{state:!0,fn:o=>{this.nodeSelect=o,this.openModalCreateFolder()},appearOnHover:!1},editNode:{state:!0,fn:this.deleteFolder,appearOnHover:!1},deleteNode:{state:!0,fn:this.selectPathMove,appearOnHover:!1},showTags:!0}}},methods:{modalDeleteFolder(){console.log("target delete",this.temp);const e=this.$refs["my-tree"].findNodePath(this.temp.node.id).slice(-2,-1)[0];if(e===void 0){console.log("noCHILD");var s=this.$refs["my-tree"].nodes.findIndex(d=>d.id==this.temp.node.id);this.$refs["my-tree"].nodes.splice(s,1)}else{const d=this.$refs["my-tree"].findNode(e);if(d.nodes===void 0){var s=this.$refs["my-tree"].nodes.findIndex(x=>x.id==this.temp.node.id);this.$refs["my-tree"].nodes.splice(s,1),$("#staticBackdrop4").modal("hide"),this.saveDeleteFolder(this.temp.node.id);return}const l=d.nodes.findIndex(r=>r.id==this.temp.node.id);d.nodes.splice(l,1)}$("#staticBackdrop4").modal("hide"),this.saveDeleteFolder(this.temp.node.id)},deleteFolder(o,e){console.log("deleteforlder",o,e),this.temp={index:e,node:o},$("#staticBackdrop4").modal("show")},editFolder(){this.saveEditFolder()},openModalEdit(o,e){this.targetEditIndex=e,$("#staticBackdrop2").modal("show")},openModalCreateFolder(){$("#staticBackdrop").modal("show")},openCreateFolderRootModal(){$("#staticBackdrop3").modal("show")},expandTreeFunction(o){this.selectPathMove(this.$refs["my-tree"].findNode(o))},openContextmenu(o,e){this.showContextMenu=!0,this.selected.row=e,this.selected.clientX=(o.pageX||o.clientX)+1+"px",this.selected.clientY=(o.pageY||o.clientY)+"px",this.selectedIdDocument=e._id,this.pathMoveSelected=e.data.categories},createFolderRoot(){this.saveRootFolder()},createFolder(o=null){this.saveChildFolder()},pathMoveSelectedRemove(o,e){delete this.pathMoveSelected[o],this.pathMoveSelected=this.pathMoveSelected.filter(function(s){return typeof s!="undefined"})},selectPathMove(o){this.nodeSelect=o},selectPathMoveChild(o){this.nodeSelect=o,this.nodeSelect.state={checked:!0,selected:!0,expanded:!0}},mySelectedFunction:function(o,e){},getFolderAll(){const o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth:this.auth})};fetch(window.ENDPOINT+"/folders/v2/default/documents",o).then(e=>e.json()).then(e=>{this.treeDisplayData=this.prepareArray(e)})},saveFolders(){this.$Progress.start();const o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth:this.auth,data:this.treeDisplayData})};fetch(this.endpointSave,o).then(e=>e.json()).then(e=>{this.$Progress.finish()})},saveEditFolder(){this.$Progress.start();const o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth:this.auth,text:this.nameEditFolder.title,id:this.nodeSelect.nodes[this.targetEditIndex].id})};fetch(window.ENDPOINT+"/folders/v2/default/documents/edit",o).then(e=>e.json()).then(e=>{this.nodeSelect.nodes[this.targetEditIndex].text=this.nameEditFolder.title,this.nameEditFolder={title:null},$("#staticBackdrop2").modal("hide"),this.$Progress.finish()})},getChilds(o){this.$Progress.start();const e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth:this.auth,parent:o})};fetch(window.ENDPOINT+"/folders/v2/default/documents/childs",e).then(s=>s.json()).then(s=>{this.$refs["my-tree"].findNode(o).nodes=this.prepareArray(s),this.nodeSelect=this.prepareArray(s),this.$Progress.finish()})},saveRootFolder(){this.$Progress.start();const o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth:this.auth,text:this.nameNewFolder.title})};fetch(window.ENDPOINT+"/folders/v2/default/documents/save/root",o).then(e=>e.json()).then(e=>{const s={text:this.nameNewFolder.title,id:e.id,state:{checked:!1,selected:!1,expanded:!1}};this.treeDisplayData.push(s),$("#staticBackdrop3").modal("hide"),this.nameNewFolder={title:null},this.$Progress.finish()})},saveChildFolder(){this.$Progress.start();const o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth:this.auth,text:this.nameNewFolder.title,parent:this.nodeSelect.id})};fetch(window.ENDPOINT+"/folders/v2/default/documents/save/child",o).then(e=>e.json()).then(e=>{const s={text:this.nameNewFolder.title,id:e.id,state:{checked:!1,selected:!1,expanded:!1}};this.nodeSelect.nodes===void 0?(this.nodeSelect.nodes=[],this.nodeSelect.nodes.push(s)):this.nodeSelect.nodes.push(s),$("#staticBackdrop").modal("hide"),this.nameNewFolder={title:null},this.$Progress.finish()})},saveDeleteFolder(o){this.$Progress.start();const e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth:this.auth,id:o})};fetch(window.ENDPOINT+"/folders/v2/default/documents/delete",e).then(s=>s.json()).then(s=>{this.$Progress.finish()})},prepareArray(o){for(var e=[],s=o.length-1;s>=0;s--)e.push({id:o[s]._id,text:o[s].data.text,nodes:[{id:"934",text:"Cargando carpetas..",nodes:[],state:{checked:!1,selected:!1,expanded:!1}}],state:{checked:!1,selected:!1,expanded:!1}});return e}}},Le=Object.assign(Ee,{setup(o){return(e,s)=>(i(),n(h,null,[c(S),t("main",null,[t("div",E,[t("form",{class:"row",onSubmit:s[2]||(s[2]=a(d=>e.save(),["prevent"]))},[t("div",P,[c(C)]),t("div",O,[t("div",M,[t("div",B,[T,t("div",I,[t("a",{href:"#",style:{"font-size":"13pX","font-weight":"600"},onClick:s[0]||(s[0]=a(d=>e.openCreateFolderRootModal(),["prevent"]))},L),q,c(b(D),{id:"my-tree-id",ref:"my-tree","custom-options":e.myCustomOptions2,"custom-styles":e.myCustomStyles2,nodes:e.treeDisplayData},null,8,["custom-options","custom-styles","nodes"]),t("ul",A,[(i(!0),n(h,null,v(e.pathMoveSelected,(d,l)=>(i(),n("li",R,[t("a",V,[y(p(d.text)+" ",1),t("a",{href:"#",style:{"margin-left":"10px"},onClick:r=>e.pathMoveSelectedRemove(l,d.id)},J,8,X)])]))),256))])])]),t("div",{class:"col-md-8 text-left",style:{height:"calc(100vh - 70px)","border-left":"1px solid #e0e0e0","border-top":"1px solid #e0e0e0",padding:"20px",overflow:"hidden","overflow-y":"auto"},onContextmenu:s[1]||(s[1]=a(d=>e.openContextmenu(d,e.document),["prevent"]))},[t("h4",H,p(e.nodeSelect.text),1),e.nodeSelect.nodes?(i(),n("span",U,[e.nodeSelect.nodes.length===0?(i(),n("span",G," No se encontraron carpetas..")):u("",!0)])):u("",!0),e.nodeSelect.nodes?u("",!0):(i(),n("span",K," No se encontraron carpetas.. ")),t("div",Q,[(i(!0),n(h,null,v(e.nodeSelect.nodes,(d,l)=>(i(),n("div",W,[t("div",Z,[t("img",{src:k,style:{cursor:"pointer"},onClick:a(r=>e.selectPathMoveChild(d),["prevent"])},null,8,ee),t("p",{class:"text-center",style:{"font-size":"13px","font-weight":"500",cursor:"pointer"},onClick:a(r=>e.selectPathMoveChild(d),["prevent"])},p(d.text),9,te),t("a",{style:{position:"absolute",top:"0",right:"0",margin:"5px"},href:"#",onClick:a(r=>e.openModalEdit(d,l),["prevent"])},de,8,se),t("a",{style:{position:"absolute",top:"30",right:"0",margin:"5px"},href:"#",onClick:a(r=>e.deleteFolder(d,l),["prevent"])},ne,8,ae)])]))),256))])],32)])])],32)])]),t("div",{class:"box",onContextmenu:s[4]||(s[4]=d=>e.onContextMenu(d)),style:_([{position:"fixed","z-index":"1000",background:"#f3f1f1",width:"auto",height:"auto",padding:"0",border:"1px solid #E2E2E2 !important",transition:"all .2s ease"},{top:e.selected.clientY,left:e.selected.clientX}])},[t("ul",le,[t("li",{style:{padding:"10px",margin:"0","list-style":"none","padding-top":"6px","padding-bottom":"6px"},onClick:s[3]||(s[3]=d=>e.openModalCreateFolder())},ce)])],36),t("div",he,[t("div",pe,[t("form",{class:"modal-content",onSubmit:s[6]||(s[6]=a(d=>e.createFolder(),["prevent"]))},[ue,t("div",me,[m(t("input",{type:"text",class:"form-control",style:{border:"1px solid #DDDDDD","border-radius":"5px",height:"30px",padding:"5px","max-height":"30px","min-height":"36px",background:"transparent"},"onUpdate:modelValue":s[5]||(s[5]=d=>e.nameNewFolder.title=d),required:"true"},null,512),[[f,e.nameNewFolder.title]])]),fe],32)])]),t("div",ye,[t("div",ve,[t("form",{class:"modal-content",onSubmit:s[8]||(s[8]=a(d=>e.createFolderRoot(),["prevent"]))},[ge,t("div",xe,[m(t("input",{type:"text",class:"form-control",style:{border:"1px solid #DDDDDD","border-radius":"5px",height:"30px",padding:"5px","max-height":"30px","min-height":"36px",background:"transparent"},"onUpdate:modelValue":s[7]||(s[7]=d=>e.nameNewFolder.title=d),required:"true"},null,512),[[f,e.nameNewFolder.title]])]),be],32)])]),t("div",_e,[t("div",we,[t("form",{class:"modal-content",onSubmit:s[10]||(s[10]=a(d=>e.editFolder(),["prevent"]))},[ke,t("div",Fe,[m(t("input",{type:"text",class:"form-control",style:{border:"1px solid #DDDDDD","border-radius":"5px",height:"30px",padding:"5px","max-height":"30px","min-height":"36px",background:"transparent"},"onUpdate:modelValue":s[9]||(s[9]=d=>e.nameEditFolder.title=d),required:"true"},null,512),[[f,e.nameEditFolder.title]])]),Ne],32)])]),t("div",Se,[t("div",Ce,[t("form",{class:"modal-content",onSubmit:s[11]||(s[11]=a(d=>e.modalDeleteFolder(),["prevent"]))},$e,32)])])],64))}});export{Le as default};
